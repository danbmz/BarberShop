"use strict";function _regenerator(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var e,n,t="function"==typeof Symbol?Symbol:{},r=t.iterator||"@@iterator",a=t.toStringTag||"@@toStringTag";function o(t,r,a,o){var c=r&&r.prototype instanceof s?r:s,l=Object.create(c.prototype);return _regeneratorDefine2(l,"_invoke",function(t,r,a){var o,s,c,l=0,d=a||[],u=!1,p={p:0,n:0,v:e,a:f,f:f.bind(e,4),d:function(n,t){return o=n,s=0,c=e,p.n=t,i}};function f(t,r){for(s=t,c=r,n=0;!u&&l&&!a&&n<d.length;n++){var a,o=d[n],f=p.p,v=o[2];t>3?(a=v===r)&&(c=o[(s=o[4])?5:(s=3,3)],o[4]=o[5]=e):o[0]<=f&&((a=t<2&&f<o[1])?(s=0,p.v=r,p.n=o[1]):f<v&&(a=t<3||o[0]>r||r>v)&&(o[4]=t,o[5]=r,p.n=v,s=0))}if(a||t>1)return i;throw u=!0,r}return function(a,d,v){if(l>1)throw TypeError("Generator is already running");for(u&&1===d&&f(d,v),s=d,c=v;(n=s<2?e:c)||!u;){o||(s?s<3?(s>1&&(p.n=-1),f(s,c)):p.n=c:p.v=c);try{if(l=2,o){if(s||(a="next"),n=o[a]){if(!(n=n.call(o,c)))throw TypeError("iterator result is not an object");if(!n.done)return n;c=n.value,s<2&&(s=0)}else 1===s&&(n=o.return)&&n.call(o),s<2&&(c=TypeError("The iterator does not provide a '"+a+"' method"),s=1);o=e}else if((n=(u=p.n<0)?c:t.call(r,p))!==i)break}catch(n){o=e,s=1,c=n}finally{l=1}}return{value:n,done:u}}}(t,a,o),!0),l}var i={};function s(){}function c(){}function l(){}n=Object.getPrototypeOf;var d=[][r]?n(n([][r]())):(_regeneratorDefine2(n={},r,function(){return this}),n),u=l.prototype=s.prototype=Object.create(d);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,l):(e.__proto__=l,_regeneratorDefine2(e,a,"GeneratorFunction")),e.prototype=Object.create(u),e}return c.prototype=l,_regeneratorDefine2(u,"constructor",l),_regeneratorDefine2(l,"constructor",c),c.displayName="GeneratorFunction",_regeneratorDefine2(l,a,"GeneratorFunction"),_regeneratorDefine2(u),_regeneratorDefine2(u,a,"Generator"),_regeneratorDefine2(u,r,function(){return this}),_regeneratorDefine2(u,"toString",function(){return"[object Generator]"}),(_regenerator=function(){return{w:o,m:p}})()}function _regeneratorDefine2(e,n,t,r){var a=Object.defineProperty;try{a({},"",{})}catch(e){a=0}_regeneratorDefine2=function(e,n,t,r){function o(n,t){_regeneratorDefine2(e,n,function(e){return this._invoke(n,t,e)})}n?a?a(e,n,{value:t,enumerable:!r,configurable:!r,writable:!r}):e[n]=t:(o("next",0),o("throw",1),o("return",2))},_regeneratorDefine2(e,n,t,r)}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,n){if(e){if("string"==typeof e)return _arrayLikeToArray(e,n);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(e,n):void 0}}function _iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _arrayLikeToArray(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=Array(n);t<n;t++)r[t]=e[t];return r}function asyncGeneratorStep(e,n,t,r,a,o,i){try{var s=e[o](i),c=s.value}catch(e){return void t(e)}s.done?n(c):Promise.resolve(c).then(r,a)}function _asyncToGenerator(e){return function(){var n=this,t=arguments;return new Promise(function(r,a){var o=e.apply(n,t);function i(e){asyncGeneratorStep(o,r,a,i,s,"next",e)}function s(e){asyncGeneratorStep(o,r,a,i,s,"throw",e)}i(void 0)})}}!function(){var e=document.querySelector("#new-cita");function n(){var e=document.querySelector(".modal");e.classList.add("fade-Out"),setTimeout(function(){null==e||e.remove(),document.querySelector("body").classList.remove("overflow-hidden")},300)}e.onclick=function(){var r=e.dataset.uid,s=e.dataset.nombre,c=document.createElement("DIV");c.classList.add("modal"),c.innerHTML='\n        <div class="stepper" aria-label="Progreso de 3 pasos">\n            \x3c!-- NAV o TABS para navegacion --\x3e\n            <nav class="stepper-nav" role="tablist" aria-label="Navegaci√≥n de pasos">\n                \x3c!-- Paso 1 --\x3e\n                <div class="step"  data-step="1" role="presentation">\n                    <div class="step-content">\n                            <button class="step-button" role="tab" aria-selected="true" aria-controls="panel-1" id="tab-1">1</button>\n                            <div class="step-label">Informaci√≥n</div>\n                    </div>\n                </div>\n\n                \x3c!-- Paso 2 --\x3e\n                <div class="step" data-step="2" role="presentation">\n                    <div class="step-content">\n                        <button class="step-button" role="tab" aria-selected="false" aria-controls="panel-2" id="tab-2">2</button>\n                        <div class="step-label">Servicios</div>\n                    </div>\n                </div>\n\n                \x3c!-- Paso 3 --\x3e\n                <div class="step" data-step="3" role="presentation">\n                    <div class="step-content">\n                        <button class="step-button" role="tab" aria-selected="false" aria-controls="panel-3" id="tab-3">3</button>\n                        <div class="step-label">Confirmar</div>\n                    </div>\n                </div>\n            </nav>\n\n            \x3c!-- SECCIONES DE CONTENIDO O PASOS  --\x3e\n            <div id="panel-1" class="panel" role="tabpanel" aria-labelledby="tab-1">\n                <h2>Servicios</h2>\n                <p>Elige los servicios que requieres a continuaci√≥n:</p>\n                <div id="services" class="services-list"></div>\n                <div class="controls">\n                    <button class="btn-delete" id="next-0">Cancelar</button>\n                    <button class="btn secondary" id="next-1">Siguiente</button>\n                </div>\n            </div>\n            <div id="panel-2" class="panel hidden" role="tabpanel" aria-labelledby="tab-2">\n                <h2>Fecha y Hora</h2>\n                <p>Coloca la fecha y hora de tu cita. Recuerda que nuestro horario de atencion es de 9:00am a 20:00pm</p>\n                <div id="errorMessage"></div>\n                \x3c!-- FORMULARIO PARA SELECCIONAR FECHA Y HORARIOS --\x3e\n                <div>\n                    <form method="POST" class="general-form">\n                        \x3c!-- Campo de nombre --\x3e\n                        <div class="form-group">\n                            <label for="nombre" class="form-label"></label>\n                            <input \n                                type="text" \n                                id="nombre" \n                                name="nombre" \n                                class="form-input" \n                                value="'.concat(s,'" \n                                hidden>\n                        </div>\n                        \x3c!-- Campo de ID --\x3e\n                        <div class="form-group">\n                            <label for="id" class="form-label"></label>\n                            <input \n                                type="text" \n                                id="id" \n                                name="id" \n                                class="form-input" \n                                value="').concat(r,'" \n                                hidden>\n                        </div>\n                        <div class="form-group">\n                            <label for="fecha" class="form-label">D√≠a:</label>\n                            <input \n                                type="date" \n                                id="fecha" \n                                name="fecha" \n                                class="form-input"\n                                min="<?php echo date(\'Y-m-d\', strtotime(\'+1 day\')) ?>"\n                                required>\n                        </div>\n                        <div class="form-group">\n                            <label for="hora" class="form-label">Hora:</label>\n                            <input \n                                type="time" \n                                id="hora" \n                                name="hora" \n                                class="form-input"\n                                min="09:00"\n                                max="20:00"\n                                required>\n                        </div>\n                    </form>\n                </div>\n                <div class="controls space">\n                    <button class="btn secondary" id="back-2">Atr√°s</button>\n                    <button class="btn primary" id="next-2">Siguiente</button>\n                </div>\n            </div>\n            <div id="panel-3" class="panel hidden" role="tabpanel" aria-labelledby="tab-3">\n                <h2>Resumen</h2>\n                <p>Antes de confirmar, verifica que los datos son correctos.</p>\n                <div class="reservation-summary"></div>\n                <div class="controls space">\n                    <button class="btn secondary" id="back-3">Atr√°s</button>\n                    <button class="btn primary" id="confirm">Confirmar reserva</button>\n                </div>\n            </div>\n        </div>\n        ');var l=document.querySelector("body");l.classList.add("overflow-hidden"),l.appendChild(c),document.getElementById("next-1").addEventListener("click",function(){return a(2)}),document.getElementById("next-2").addEventListener("click",function(){(function(){t.nombre=document.querySelector("#nombre").value,t.id=document.querySelector("#id").value;var e=document.querySelector("#fecha").value,n=document.querySelector("#hora").value,r=function(e,n){var t="09:00",r="20:00",a=new Date;a.setHours(0,0,0,0);var o=new Date(e);if(o.setHours(0,0,0,0),o<a||n<t||n>r)return{valid:!1,message:"Elige una fecha y hora correcta."};return{valid:!0,message:"Fecha y hora v√°lidas."}}(e,n);r.valid?(t.fecha=e,t.hora=n):(a=r.message,(o=document.querySelector("#errorMessage")).style.display="block",o.classList.add("error","alerta"),o.textContent=a,setTimeout(function(){o.style.display="none"},3e3));var a,o;return r})().valid&&(a(3),function(){var e=t.nombre,n=t.fecha,r=t.hora,a=t.servicios,o=document.querySelector(".reservation-summary");o.innerHTML="";var i=document.createElement("DIV");i.classList.add("reservation-card");var s=new Date(n);s.setMinutes(s.getMinutes()+s.getTimezoneOffset());var c=s.toLocaleDateString("es-MX",{dateStyle:"long"}),l=e.split(" ")[0],d=l.slice(0,1).toUpperCase()+l.slice(1);i.innerHTML='\n        <div class="summary-section">\n            <p id="summaryDate">'.concat(d,' tu pr√≥xima cita ser√° el d√≠a <span class="summary-span">').concat(c," a las ").concat(r," horas</span>. Los servicios que seleccionaste son los siguientes:</p>\n        </div>\n        "),a.forEach(function(e){var n=e.nombre,t=e.precio,r=document.createElement("DIV");r.classList.add("card-content"),r.innerHTML='\n            <h3><span class="icon">‚úÇÔ∏è</span>'.concat(n,'</h3>\n            <div class="details">\n                <span>üí≤ ').concat(t,"</span>\n            </div>\n            "),i.appendChild(r)}),o.appendChild(i)}())}),document.getElementById("back-2").addEventListener("click",function(){return a(1)}),document.getElementById("back-3").addEventListener("click",function(){return a(2)}),document.getElementById("confirm").addEventListener("click",function(){!function(){i.apply(this,arguments)}()}),function(){o.apply(this,arguments)}(),document.querySelector("#next-1").disabled=!0,document.querySelector("#next-0").onclick=n};var t={id:"",nombre:"",fecha:"",hora:"",servicios:[]},r=1;function a(e){var n=Array.from(document.querySelectorAll(".step")),t={1:document.getElementById("panel-1"),2:document.getElementById("panel-2"),3:document.getElementById("panel-3")};e<1||e>3||(r=e,Object.keys(t).forEach(function(e){t[e].classList.toggle("hidden",Number(e)!==r)}),n.forEach(function(e){var n=Number(e.dataset.step);e.classList.remove("active","completed"),e.querySelector(".step-button").setAttribute("aria-selected","false"),n<r?(e.classList.add("completed"),e.querySelector(".step-button").setAttribute("aria-selected","false")):n===r&&(e.classList.add("active"),e.querySelector(".step-button").setAttribute("aria-selected","true"))}))}function o(){return(o=_asyncToGenerator(_regenerator().m(function e(){var n,t;return _regenerator().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,fetch("/api/services");case 1:return n=e.v,e.n=2,n.json();case 2:s(e.v),e.n=4;break;case 3:e.p=3,t=e.v,console.log(t);case 4:return e.a(2)}},e,null,[[0,3]])}))).apply(this,arguments)}function i(){return(i=_asyncToGenerator(_regenerator().m(function e(){var n,r,a,o,i,s,c,l;return _regenerator().w(function(e){for(;;)switch(e.p=e.n){case 0:return n=t.id,t.nombre,r=t.fecha,a=t.hora,o=t.servicios,i=o.map(function(e){return e.id}),(s=new FormData).append("usuarioId",n),s.append("fecha",r),s.append("hora",a),s.append("idService",i),c="".concat(location.origin,"/api/reservation/create"),e.p=1,e.n=2,fetch(c,{method:"POST",body:s});case 2:return l=e.v,e.n=3,l.json();case 3:e.v.respuesta.resultado&&Swal.fire({title:"Good job!",text:"Tu reservaci√≥n ha sido creada!",icon:"success",button:"OK"}).then(function(){window.location.reload()}),e.n=5;break;case 4:e.p=4,e.v,Swal.fire({icon:"error",title:"Oops...",text:"Algo salio mal! Intentalo de nuevo."});case 5:return e.a(2)}},e,null,[[1,4]])}))).apply(this,arguments)}function s(e){var n=document.querySelector(".services-list");e.forEach(function(e){var r=e.id,a=e.nombre,o=e.precio,i=document.createElement("div");i.classList.add("card"),i.dataset.id=r,i.innerHTML='\n            <div class="card-content">\n                <h3><span class="icon">‚úÇÔ∏è</span>'.concat(a,'</h3>\n                <p>Cortes modernos y cl√°sicos adaptados a tu estilo personal</p>\n                <div class="details">\n                    <span>‚è±Ô∏è 45 min</span>\n                    <span>üí≤ Desde $').concat(o,"</span>\n                </div>\n            </div>\n            "),i.onclick=function(){!function(e){var n=e.id,r=t.servicios,a=document.querySelector('[data-id="'.concat(n,'"]'));r.some(function(e){return e.id===n})?(t.servicios=r.filter(function(e){return e.id!==n}),a.classList.remove("selected")):(t.servicios=[].concat(_toConsumableArray(r),[e]),a.classList.add("selected"));t.servicios.length>0?document.querySelector("#next-1").disabled=!1:document.querySelector("#next-1").disabled=!0}(e)},n.appendChild(i)})}}();